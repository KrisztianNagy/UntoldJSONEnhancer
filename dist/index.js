!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("JSONPointer",[],r):"object"==typeof exports?exports.JSONPointer=r():e.JSONPointer=r()}("undefined"!=typeof self?self:this,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=2)}([function(e,r,t){"undefined"!=typeof self&&self,e.exports=function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([function(e,r,t){"use strict";function n(e,r,t,o){this.message=e,this.expected=r,this.found=t,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,r){function t(){this.constructor=e}t.prototype=r.prototype,e.prototype=new t}(n,Error),n.buildMessage=function(e,r){var t={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var r,t="";for(r=0;r<e.parts.length;r++)t+=e.parts[r]instanceof Array?i(e.parts[r][0])+"-"+i(e.parts[r][1]):i(e.parts[r]);return"["+(e.inverted?"^":"")+t+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}return"Expected "+function(e){var r,n,o,i=new Array(e.length);for(r=0;r<e.length;r++)i[r]=(o=e[r],t[o.type](o));if(i.sort(),i.length>0){for(r=1,n=1;r<i.length;r++)i[r-1]!==i[r]&&(i[n]=i[r],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but end of input found."},e.exports={SyntaxError:n,parse:function(e,r){r=void 0!==r?r:{};var t,o={},i={Entry:dr},a=dr,s=function(e){return r.queryBuilder.buildPathCombination(e)},u=function(e,t){return r.queryBuilder.buildPath(e,t)},l=function(e,t){return r.queryBuilder.buildIdentifier(t,"|"===e)},c="{",p=lr("{",!1),h="}",f=lr("}",!1),g=function(e){return e},d=".",y=lr(".",!1),m="|",v=lr("|",!1),P=function(e,t){return r.queryBuilder.buildFilterContent(e,t)},b=function(e,t){return r.queryBuilder.buildCombinedFilter(e,t)},x="(",A=lr("(",!1),C=")",E=lr(")",!1),T=function(e){return r.queryBuilder.buildParenthesis(e)},N=function(e,t){return r.queryBuilder.buildOperatorPlusFilterScope(e,t)},S=function(e,t){return r.queryBuilder.buildOperatorPlusComparer(e,t)},O=pr("&&"),w="&&",j=lr("&&",!1),M=pr("||"),Q="||",F=lr("||",!1),L=function(e,t,n){return r.queryBuilder.buildComparison(e,t,n)},k=function(e){return r.queryBuilder.buildValue(e)},q=function(e,r){return e+(r?r.join(""):"")},B="[",V=lr("[",!1),I="]",U=lr("]",!1),_=function(e){return r.queryBuilder.buildIdentifier(e,!1)},R=/^[a-zA-Z]/,J=cr([["a","z"],["A","Z"]],!1,!1),H=/^[a-zA-Z0-9]/,z=cr([["a","z"],["A","Z"],["0","9"]],!1,!1),Z=pr("whitespace"),D=/^[ \t\n\r]/,G=cr([" ","\t","\n","\r"],!1,!1),K=pr("string"),W='"',X=lr('"',!1),Y=function(e){return e.join("")},$="'",ee=lr("'",!1),re="\\",te=lr("\\",!1),ne={type:"any"},oe=function(e){return e},ie=function(e){return e},ae="b",se=lr("b",!1),ue=function(){return"\b"},le="f",ce=lr("f",!1),pe=function(){return"\f"},he="n",fe=lr("n",!1),ge=function(){return"\n"},de="r",ye=lr("r",!1),me=function(){return"\r"},ve="t",Pe=lr("t",!1),be=function(){return"\t"},xe="v",Ae=lr("v",!1),Ce=function(){return"\v"},Ee="<=",Te=lr("<=",!1),Ne="<",Se=lr("<",!1),Oe=">=",we=lr(">=",!1),je=">",Me=lr(">",!1),Qe=":",Fe=lr(":",!1),Le="!==",ke=lr("!==",!1),qe="!=",Be=lr("!=",!1),Ve="===",Ie=lr("===",!1),Ue="==",_e=lr("==",!1),Re=function(){return!0},Je=function(){return!1},He=function(){return null},ze=/^[0-9]/,Ze=cr([["0","9"]],!1,!1),De=function(e,r){return e&&e.length?parseFloat(e.join("")+r.join(""),10):parseInt(r.join(""),10)},Ge=function(e){return parseInt(e.join(""),10)},Ke=pr("true"),We="true",Xe=lr("true",!1),Ye=pr("false"),$e="false",er=lr("false",!1),rr=pr("null"),tr="null",nr=lr("null",!1),or=0,ir=[{line:1,column:1}],ar=0,sr=[],ur=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=i[r.startRule]}function lr(e,r){return{type:"literal",text:e,ignoreCase:r}}function cr(e,r,t){return{type:"class",parts:e,inverted:r,ignoreCase:t}}function pr(e){return{type:"other",description:e}}function hr(r){var t,n=ir[r];if(n)return n;for(t=r-1;!ir[t];)t--;for(n={line:(n=ir[t]).line,column:n.column};t<r;)10===e.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return ir[r]=n,n}function fr(e,r){var t=hr(e),n=hr(r);return{start:{offset:e,line:t.line,column:t.column},end:{offset:r,line:n.line,column:n.column}}}function gr(e){or<ar||(or>ar&&(ar=or,sr=[]),sr.push(e))}function dr(){var e,r;for(e=[],r=yr();r!==o;)e.push(r),r=yr();return e!==o&&(e=s(e)),e}function yr(){var e,r,t,n;if(e=or,r=[],(t=mr())!==o)for(;t!==o;)r.push(t),t=mr();else r=o;if(r!==o&&(t=Nr())!==o?((n=vr())===o&&(n=null),n!==o?e=r=u(r,n):(or=e,e=o)):(or=e,e=o),e===o){for(e=or,r=[],t=mr();t!==o;)r.push(t),t=mr();r!==o&&(t=Nr())!==o&&(n=vr())!==o?e=r=u(r,n):(or=e,e=o)}return e}function mr(){var r;return(r=function(){var r,t,n;return r=or,(t=function(){var r;return 46===e.charCodeAt(or)?(r=d,or++):(r=o,0===ur&&gr(y)),r===o&&(124===e.charCodeAt(or)?(r=m,or++):(r=o,0===ur&&gr(v))),r}())!==o&&(n=function(){var r,t,n,i;if(r=or,(t=function(){var r;return R.test(e.charAt(or))?(r=e.charAt(or),or++):(r=o,0===ur&&gr(J)),r}())!==o){for(n=[],i=Tr();i!==o;)n.push(i),i=Tr();n!==o?(t=q(t,n),r=t):(or=r,r=o)}else or=r,r=o;return r}())!==o?(t=l(t,n),r=t):(or=r,r=o),r}())===o&&(r=function(){var r,t,n,i;return r=or,91===e.charCodeAt(or)?(t=B,or++):(t=o,0===ur&&gr(V)),t!==o&&Nr()!==o&&(n=function(){var r;return(r=Sr())===o&&(r=function(){var r,t;if(r=[],ze.test(e.charAt(or))?(t=e.charAt(or),or++):(t=o,0===ur&&gr(Ze)),t!==o)for(;t!==o;)r.push(t),ze.test(e.charAt(or))?(t=e.charAt(or),or++):(t=o,0===ur&&gr(Ze));else r=o;return r!==o&&(r=Ge(r)),r}()),r}())!==o&&Nr()!==o?(93===e.charCodeAt(or)?(i=I,or++):(i=o,0===ur&&gr(U)),i!==o?(t=_(n),r=t):(or=r,r=o)):(or=r,r=o),r}()),r}function vr(){var r,t,n,i;return r=or,123===e.charCodeAt(or)?(t=c,or++):(t=o,0===ur&&gr(p)),t!==o&&Nr()!==o&&(n=function(){var e,r,t,n;if(e=or,(r=Pr())!==o){for(t=[],n=xr();n!==o;)t.push(n),n=xr();t!==o&&(n=Nr())!==o?(r=P(r,t),e=r):(or=e,e=o)}else or=e,e=o;return e}())!==o&&Nr()!==o?(125===e.charCodeAt(or)?(i=h,or++):(i=o,0===ur&&gr(f)),i!==o?r=t=g(n):(or=r,r=o)):(or=r,r=o),r}function Pr(){var r;return(r=function(){var r,t,n,i;return r=or,Nr()!==o?(40===e.charCodeAt(or)?(t=x,or++):(t=o,0===ur&&gr(A)),t!==o&&(n=Pr())!==o?(41===e.charCodeAt(or)?(i=C,or++):(i=o,0===ur&&gr(E)),i!==o&&Nr()!==o?r=T(n):(or=r,r=o)):(or=r,r=o)):(or=r,r=o),r}())===o&&(r=function(){var e,r,t,n;if(e=or,(r=Cr())!==o){for(t=[],n=br();n!==o;)t.push(n),n=br();t!==o&&(n=Nr())!==o?e=r=b(r,t):(or=e,e=o)}else or=e,e=o;return e}()),r}function br(){var e;return(e=function(){var e,r,t,n;return e=or,(r=Nr())!==o&&(t=Ar())!==o&&Nr()!==o&&(n=Cr())!==o?(r=S(t,n),e=r):(or=e,e=o),e}())===o&&(e=xr()),e}function xr(){var e,r,t;return e=or,Nr()!==o&&(r=Ar())!==o&&Nr()!==o&&(t=Pr())!==o?e=N(r,t):(or=e,e=o),e}function Ar(){var r;return(r=function(){var r;return ur++,e.substr(or,2)===w?(r=w,or+=2):(r=o,0===ur&&gr(j)),ur--,r===o&&0===ur&&gr(O),r}())===o&&(r=function(){var r;return ur++,e.substr(or,2)===Q?(r=Q,or+=2):(r=o,0===ur&&gr(F)),ur--,r===o&&0===ur&&gr(M),r}()),r}function Cr(){var r,t,n,i;return r=or,(t=Er())!==o&&Nr()!==o&&(n=function(){var r;return e.substr(or,2)===Ee?(r=Ee,or+=2):(r=o,0===ur&&gr(Te)),r===o&&(60===e.charCodeAt(or)?(r=Ne,or++):(r=o,0===ur&&gr(Se)),r===o&&(e.substr(or,2)===Oe?(r=Oe,or+=2):(r=o,0===ur&&gr(we)),r===o&&(62===e.charCodeAt(or)?(r=je,or++):(r=o,0===ur&&gr(Me)),r===o&&(58===e.charCodeAt(or)?(r=Qe,or++):(r=o,0===ur&&gr(Fe)),r===o&&(e.substr(or,3)===Le?(r=Le,or+=3):(r=o,0===ur&&gr(ke)),r===o&&(e.substr(or,2)===qe?(r=qe,or+=2):(r=o,0===ur&&gr(Be)),r===o&&(e.substr(or,3)===Ve?(r=Ve,or+=3):(r=o,0===ur&&gr(Ie)),r===o&&(e.substr(or,2)===Ue?(r=Ue,or+=2):(r=o,0===ur&&gr(_e)))))))))),r}())!==o&&Nr()!==o&&(i=Er())!==o?r=t=L(t,n,i):(or=r,r=o),r}function Er(){var r,t;return r=or,(t=function(){var r,t;return(r=function(){var r,t,n,i;if(r=or,t=or,ze.test(e.charAt(or))?(n=e.charAt(or),or++):(n=o,0===ur&&gr(Ze)),n!==o?(46===e.charCodeAt(or)?(i=d,or++):(i=o,0===ur&&gr(y)),i!==o?t=n=[n,i]:(or=t,t=o)):(or=t,t=o),t===o&&(t=null),t!==o){if(n=[],ze.test(e.charAt(or))?(i=e.charAt(or),or++):(i=o,0===ur&&gr(Ze)),i!==o)for(;i!==o;)n.push(i),ze.test(e.charAt(or))?(i=e.charAt(or),or++):(i=o,0===ur&&gr(Ze));else n=o;n!==o?(t=De(t,n),r=t):(or=r,r=o)}else or=r,r=o;return r}())===o&&(r=Sr())===o&&(r=or,(t=function(){var r;return ur++,e.substr(or,4)===We?(r=We,or+=4):(r=o,0===ur&&gr(Xe)),ur--,r===o&&0===ur&&gr(Ke),r}())!==o&&(t=Re()),(r=t)===o&&(r=or,(t=function(){var r;return ur++,e.substr(or,5)===$e?(r=$e,or+=5):(r=o,0===ur&&gr(er)),ur--,r===o&&0===ur&&gr(Ye),r}())!==o&&(t=Je()),(r=t)===o&&(r=or,(t=function(){var r;return ur++,e.substr(or,4)===tr?(r=tr,or+=4):(r=o,0===ur&&gr(nr)),ur--,r===o&&0===ur&&gr(rr),r}())!==o&&(t=He()),r=t))),r}())!==o&&(t=k(t)),(r=t)===o&&(r=yr()),r}function Tr(){var r;return H.test(e.charAt(or))?(r=e.charAt(or),or++):(r=o,0===ur&&gr(z)),r}function Nr(){var r,t;for(ur++,r=[],D.test(e.charAt(or))?(t=e.charAt(or),or++):(t=o,0===ur&&gr(G));t!==o;)r.push(t),D.test(e.charAt(or))?(t=e.charAt(or),or++):(t=o,0===ur&&gr(G));return ur--,r===o&&(t=o,0===ur&&gr(Z)),r}function Sr(){var r,t,n,i;if(ur++,r=or,34===e.charCodeAt(or)?(t=W,or++):(t=o,0===ur&&gr(X)),t!==o){for(n=[],i=Or();i!==o;)n.push(i),i=Or();n!==o?(34===e.charCodeAt(or)?(i=W,or++):(i=o,0===ur&&gr(X)),i!==o?r=t=Y(n):(or=r,r=o)):(or=r,r=o)}else or=r,r=o;if(r===o)if(r=or,39===e.charCodeAt(or)?(t=$,or++):(t=o,0===ur&&gr(ee)),t!==o){for(n=[],i=wr();i!==o;)n.push(i),i=wr();n!==o?(39===e.charCodeAt(or)?(i=$,or++):(i=o,0===ur&&gr(ee)),i!==o?r=t=Y(n):(or=r,r=o)):(or=r,r=o)}else or=r,r=o;return ur--,r===o&&(t=o,0===ur&&gr(K)),r}function Or(){var r,t,n;return r=or,t=or,ur++,34===e.charCodeAt(or)?(n=W,or++):(n=o,0===ur&&gr(X)),n===o&&(92===e.charCodeAt(or)?(n=re,or++):(n=o,0===ur&&gr(te))),ur--,n===o?t=void 0:(or=t,t=o),t!==o?(e.length>or?(n=e.charAt(or),or++):(n=o,0===ur&&gr(ne)),n!==o?r=t=oe(n):(or=r,r=o)):(or=r,r=o),r===o&&(r=or,92===e.charCodeAt(or)?(t=re,or++):(t=o,0===ur&&gr(te)),t!==o&&(n=jr())!==o?r=t=ie(n):(or=r,r=o)),r}function wr(){var r,t,n;return r=or,t=or,ur++,39===e.charCodeAt(or)?(n=$,or++):(n=o,0===ur&&gr(ee)),n===o&&(92===e.charCodeAt(or)?(n=re,or++):(n=o,0===ur&&gr(te))),ur--,n===o?t=void 0:(or=t,t=o),t!==o?(e.length>or?(n=e.charAt(or),or++):(n=o,0===ur&&gr(ne)),n!==o?r=t=oe(n):(or=r,r=o)):(or=r,r=o),r===o&&(r=or,92===e.charCodeAt(or)?(t=re,or++):(t=o,0===ur&&gr(te)),t!==o&&(n=jr())!==o?r=t=ie(n):(or=r,r=o)),r}function jr(){var r,t;return 39===e.charCodeAt(or)?(r=$,or++):(r=o,0===ur&&gr(ee)),r===o&&(34===e.charCodeAt(or)?(r=W,or++):(r=o,0===ur&&gr(X)),r===o&&(92===e.charCodeAt(or)?(r=re,or++):(r=o,0===ur&&gr(te)),r===o&&(r=or,98===e.charCodeAt(or)?(t=ae,or++):(t=o,0===ur&&gr(se)),t!==o&&(t=ue()),(r=t)===o&&(r=or,102===e.charCodeAt(or)?(t=le,or++):(t=o,0===ur&&gr(ce)),t!==o&&(t=pe()),(r=t)===o&&(r=or,110===e.charCodeAt(or)?(t=he,or++):(t=o,0===ur&&gr(fe)),t!==o&&(t=ge()),(r=t)===o&&(r=or,114===e.charCodeAt(or)?(t=de,or++):(t=o,0===ur&&gr(ye)),t!==o&&(t=me()),(r=t)===o&&(r=or,116===e.charCodeAt(or)?(t=ve,or++):(t=o,0===ur&&gr(Pe)),t!==o&&(t=be()),(r=t)===o&&(r=or,118===e.charCodeAt(or)?(t=xe,or++):(t=o,0===ur&&gr(Ae)),t!==o&&(t=Ce()),r=t)))))))),r}if((t=a())!==o&&or===e.length)return t;throw t!==o&&or<e.length&&gr({type:"end"}),function(e,r,t){return new n(n.buildMessage(e,r),e,r,t)}(sr,ar<e.length?e.charAt(ar):null,ar<e.length?fr(ar,ar+1):fr(ar,ar))}}},function(e,r,t){"use strict";t.r(r);var n=t(0);let o;!function(e){e[e.Identifier=0]="Identifier",e[e.Value=1]="Value",e[e.Comparison=2]="Comparison",e[e.Comparer=3]="Comparer",e[e.LogicalOperatorPlusComparison=4]="LogicalOperatorPlusComparison",e[e.LogicalOperatorHierarchy=5]="LogicalOperatorHierarchy",e[e.LogicalOperatorPlusFilterScope=6]="LogicalOperatorPlusFilterScope"}(o||(o={}));class i{buildPath(e,r){let t=null,n=null;if(e.forEach(e=>{t?(n.next=e,n=n.next):n=t=e}),r){if(!n)return r;n.next=r}return t}buildPathCombination(e){let r=null,t=null;return e.forEach(e=>{for(r?t.next=e:t=r=e;t.next;)t=t.next}),r}buildIdentifier(e,r){return{operationPayload:{memberName:e,isFlat:r},operationType:o.Identifier}}buildValue(e){return{operationPayload:e,operationType:o.Value}}buildComparison(e,r,t){return{operationPayload:{left:e,comparer:{operationType:o.Comparer,operationPayload:r},right:t},operationType:o.Comparison}}buildOperatorPlusComparer(e,r){return{operationPayload:{operator:e,comparison:r},operationType:o.LogicalOperatorPlusComparison}}buildOperatorPlusFilterScope(e,r){return{operationPayload:{operator:e,scope:r},operationType:o.LogicalOperatorPlusFilterScope}}buildCombinedFilter(e,r){const t={operationType:o.LogicalOperatorHierarchy,operationPayload:{operator:"",comparisons:[e]}};return this.mergeFilters(t,r)}buildParenthesis(e){return{operationType:o.LogicalOperatorHierarchy,operationPayload:{operator:"",comparisons:[e]}}}buildFilterContent(e,r){return r.length?this.mergeFilters(e,r):e}mergeFilters(e,r){const t=[];let n=e,i=n;return t.push(n),r.forEach(e=>{n||(i=n,t.push(n));const r=e.operationPayload.scope?e.operationPayload.scope.operationPayload.comparisons:[e.operationPayload.comparison];if(""===i.operationPayload.operator||e.operationPayload.operator===i.operationPayload.operator)i.operationPayload.operator=e.operationPayload.operator,i.operationPayload.comparisons=[...i.operationPayload.comparisons,...r];else if("&&"===e.operationPayload.operator){const n=i.operationPayload.comparisons.pop(),a={operationType:o.LogicalOperatorHierarchy,operationPayload:{operator:e.operationPayload.operator,comparisons:[n,...r]}};i.operationPayload.comparisons.push(a),t.push(a)}else{const a=t.pop(),s={operationType:o.LogicalOperatorHierarchy,operationPayload:{operator:e.operationPayload.operator,comparisons:[a,...r]}};i=s,t.length||(n=i),t.push(s)}}),n}}class a{constructor(){}getNextPointer(e){let r=this.getNextValue(e);const t={eachElement:!1,previous:e};return r.values?t.multipleTargets=r.values.map(e=>({targetPosition:e,propertyName:""})):t.singleTarget={propertyName:"",targetPosition:r.value},t}getNextValue(e){let r={};if(e.multipleTargets)e.eachElement?(r={values:[]},e.multipleTargets.forEach(e=>{Array.isArray(e.targetPosition)?e.targetPosition.forEach(t=>{r.values=[...r.values,...this.getProperty(t,e.propertyName)]}):r.values=[...r.values,null]})):r={values:e.multipleTargets.map(e=>this.getProperty(e.targetPosition,e.propertyName))};else if(e.singleTarget)if(e.eachElement){const t=Array.isArray(e.singleTarget.targetPosition);r=t?{values:e.singleTarget.targetPosition.map(r=>{const t=this.getProperty(r,e.singleTarget.propertyName);return void 0===t?null:t})}:{values:[]}}else{const t=this.getProperty(e.singleTarget.targetPosition,e.singleTarget.propertyName);r={value:void 0===t?null:t}}else r={};return r}getProperty(e,r){return Array.isArray(r)?r.map(r=>e?e[r]:null):e?e[r]:null}}class s extends a{resultCount(){return this.propertyPointer&&(this.propertyPointer.singleTarget||this.propertyPointer.multipleTargets)?this.propertyPointer.singleTarget?1:this.propertyPointer.multipleTargets?this.propertyPointer.multipleTargets.length:0:0}getAll(){if(!this.propertyPointer||!this.propertyPointer.singleTarget&&!this.propertyPointer.multipleTargets)return[];const e=this.getNextValue(this.propertyPointer);return void 0===e?[]:this.propertyPointer.eachElement||this.propertyPointer.multipleTargets?e.values:[e.value]}getSingle(){const e=this.getAll();return e.length?e[0]:null}getAt(e){const r=this.getAll();return r&&r.length>e?r[e]:null}parents(){return this.parentsAt(0)}parentsAt(e){if(!this.propertyPointer||!this.propertyPointer.singleTarget&&!this.propertyPointer.multipleTargets)return[];const r=this.getAt(e);return this.getParentReferenceArray(this.propertyPointer,r)}setAll(e){this.set(e)}setSingle(e){this.set(e,0)}setAt(e,r){this.set(e,r)}set(e,r){const t="number"==typeof r;if(this.propertyPointer&&(this.propertyPointer.singleTarget||this.propertyPointer.multipleTargets))if(this.propertyPointer.multipleTargets){let n=0;for(let o=0;o<this.propertyPointer.multipleTargets.length;o++){const i=this.propertyPointer.multipleTargets[o];if(Array.isArray(i.propertyName))for(let o=0;o<i.propertyName.length;o++){if(!t||r===n){const r=i.propertyName[o];if(i.targetPosition[r]=e,t)return}n++}else{if((!t||r===n)&&(i.targetPosition[i.propertyName]=e,t))return;n++}}}else if(this.propertyPointer.eachElement&&this.propertyPointer.singleTarget){if(Array.isArray(this.propertyPointer.singleTarget.targetPosition))for(let n=0;n<this.propertyPointer.singleTarget.targetPosition.length;n++)if((!t||r===n)&&(this.propertyPointer.singleTarget.targetPosition[n][this.propertyPointer.singleTarget.propertyName]=e,t))return}else if(this.propertyPointer.singleTarget)if(Array.isArray(this.propertyPointer.singleTarget.propertyName)){for(let n=0;n<this.propertyPointer.singleTarget.propertyName.length;n++)if(!t||r===n){const r=this.propertyPointer.singleTarget.propertyName[n];if(this.propertyPointer.singleTarget.targetPosition[r]=e,t)return}}else null!==this.propertyPointer.singleTarget.targetPosition&&(t&&0!==r||(this.propertyPointer.singleTarget.targetPosition[this.propertyPointer.singleTarget.propertyName]=e))}getParentReferenceArray(e,r){if(null===e)return[];let t=e,n=r;const o=[];for(;t;){if(t.singleTarget)if(t.eachElement)for(let e=0;e<t.singleTarget.targetPosition.length;e++)t.singleTarget.targetPosition[e][t.singleTarget.propertyName]===n&&(n=t.singleTarget.targetPosition[e]);else n=t.singleTarget.targetPosition;else if(t.multipleTargets)for(let e=0;e<t.multipleTargets.length;e++){const r=t.multipleTargets[e];if(t.eachElement&&r.propertyName)for(let e=0;e<r.propertyName.length;e++){const t=r.targetPosition[r.propertyName[e]];t===n&&(n=t)}else{const e=r.targetPosition[r.propertyName];e===n&&(n=e)}}o.push(n),t=t.previous}return o}constructor(e,r,t){super(),this.isQueryValid=e,this.propertyPointer=r,this.error=t}}class u extends a{constructor(){super()}process(e,r){return this.resolveQuery(e,null,r)}resolveQuery(e,r,t){let n=r?this.getNextPointer(r):{singleTarget:{propertyName:"",targetPosition:t},eachElement:!1};switch(e.operationType){case o.Identifier:n.eachElement=e.operationPayload.isFlat,n.multipleTargets?n.multipleTargets.forEach(r=>{r.propertyName=e.operationPayload.memberName}):n.singleTarget.propertyName=e.operationPayload.memberName;break;case o.Comparison:case o.LogicalOperatorHierarchy:n=this.filterAll(r,e);break;default:throw"Not implemented operation type on "+JSON.stringify(e)}return e.next?this.resolveQuery(e.next,n):n}filterAll(e,r){const t=new s(!0,e),n={eachElement:!1,previous:e};if(e.multipleTargets){const e=t.getAll();n.multipleTargets=e.map(e=>({targetPosition:e,propertyName:this.filterSingle(e,r)}))}else if(e.singleTarget){const e=t.getSingle();n.singleTarget={targetPosition:e,propertyName:this.filterSingle(e,r)}}return n}filterSingle(e,r){const t=[];return e&&Array.isArray(e)&&e.forEach((e,n)=>{"object"==typeof e&&(r.operationType===o.Comparison?this.compare(e,r):this.combine(e,r))&&t.push(n)}),t}combine(e,r){const t="&&"===r.operationPayload.operator;for(let n=0;n<r.operationPayload.comparisons.length;n++){const i=r.operationPayload.comparisons[n],a=i.operationType===o.Comparison?this.compare(e,i):this.combine(e,i);if(a&&!t)return!0;if(!a&&t)return!1}return t}compare(e,r){const{left:t,comparer:n,right:o}=r.operationPayload,i=this.getComparisonSideValue(t,e),a=this.getComparisonSideValue(o,e);let s=!1;switch(n.operationPayload){case">=":s=i>=a;break;case">":s=i>a;break;case"<=":s=i<=a;break;case"<":s=i<a;break;case"==":s=i==a;break;case"===":s=i===a;break;case"!=":s=i!=a;break;case"!==":s=i!==a;break;case":":s="string"==typeof i&&"string"==typeof a&&i.indexOf(a)>-1}return s}getComparisonSideValue(e,r){if(e.operationType===o.Identifier){const t=this.resolveQuery(e,null,r);return new s(!0,t).getSingle()}return e.operationPayload}}t.d(r,"default",function(){return l});class l{createQuery(e){try{return{isQueryValid:!0,query:n.parse(e,{queryBuilder:new i})}}catch(e){return{error:e,isQueryValid:!1,query:null}}}executeQuery(e,r){let t="string"==typeof r?this.createQuery(r):r;if(t.isQueryValid&&t.query){const r=(new u).process(t.query,e);return new s(!0,r)}return new s(!1,null,t.error)}}}]).default},function(e,r,t){!function(t){"use strict";var n=function(e,r){var t=new Error(e+" at character "+r);throw t.index=r,t.description=e,t},o={"-":!0,"!":!0,"~":!0,"+":!0},i={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},a=function(e){var r,t=0;for(var n in e)(r=n.length)>t&&e.hasOwnProperty(n)&&(t=r);return t},s=a(o),u=a(i),l={true:!0,false:!1,null:null},c=function(e){return i[e]||0},p=function(e,r,t){return{type:"||"===e||"&&"===e?"LogicalExpression":"BinaryExpression",operator:e,left:r,right:t}},h=function(e){return e>=48&&e<=57},f=function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=128&&!i[String.fromCharCode(e)]},g=function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e>=128&&!i[String.fromCharCode(e)]},d=function(e){for(var r,t,a=0,d=e.charAt,y=e.charCodeAt,m=function(r){return d.call(e,r)},v=function(r){return y.call(e,r)},P=e.length,b=function(){for(var e=v(a);32===e||9===e||10===e||13===e;)e=v(++a)},x=function(){var e,r,t=C();return b(),63!==v(a)?t:(a++,(e=x())||n("Expected expression",a),b(),58===v(a)?(a++,(r=x())||n("Expected expression",a),{type:"ConditionalExpression",test:t,consequent:e,alternate:r}):void n("Expected :",a))},A=function(){b();for(var r=e.substr(a,u),t=r.length;t>0;){if(i.hasOwnProperty(r)&&(!f(v(a))||a+r.length<e.length&&!g(v(a+r.length))))return a+=t,r;r=r.substr(0,--t)}return!1},C=function(){var e,r,t,o,i,s,u,l;if(s=E(),!(r=A()))return s;for(i={value:r,prec:c(r)},(u=E())||n("Expected expression after "+r,a),o=[s,i,u];(r=A())&&0!==(t=c(r));){for(i={value:r,prec:t};o.length>2&&t<=o[o.length-2].prec;)u=o.pop(),r=o.pop().value,s=o.pop(),e=p(r,s,u),o.push(e);(e=E())||n("Expected expression after "+r,a),o.push(i,e)}for(e=o[l=o.length-1];l>1;)e=p(o[l-1].value,o[l-2],e),l-=2;return e},E=function(){var r,t,n;if(b(),r=v(a),h(r)||46===r)return T();if(39===r||34===r)return N();if(91===r)return M();for(n=(t=e.substr(a,s)).length;n>0;){if(o.hasOwnProperty(t)&&(!f(v(a))||a+t.length<e.length&&!g(v(a+t.length))))return a+=n,{type:"UnaryExpression",operator:t,argument:E(),prefix:!0};t=t.substr(0,--n)}return!(!f(r)&&40!==r)&&w()},T=function(){for(var e,r,t="";h(v(a));)t+=m(a++);if(46===v(a))for(t+=m(a++);h(v(a));)t+=m(a++);if("e"===(e=m(a))||"E"===e){for(t+=m(a++),"+"!==(e=m(a))&&"-"!==e||(t+=m(a++));h(v(a));)t+=m(a++);h(v(a-1))||n("Expected exponent ("+t+m(a)+")",a)}return r=v(a),f(r)?n("Variable names cannot start with a number ("+t+m(a)+")",a):46===r&&n("Unexpected period",a),{type:"Literal",value:parseFloat(t),raw:t}},N=function(){for(var e,r="",t=m(a++),o=!1;a<P;){if((e=m(a++))===t){o=!0;break}if("\\"===e)switch(e=m(a++)){case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"b":r+="\b";break;case"f":r+="\f";break;case"v":r+="\v";break;default:r+=e}else r+=e}return o||n('Unclosed quote after "'+r+'"',a),{type:"Literal",value:r,raw:t+r+t}},S=function(){var r,t=v(a),o=a;for(f(t)?a++:n("Unexpected "+m(a),a);a<P&&(t=v(a),g(t));)a++;return r=e.slice(o,a),l.hasOwnProperty(r)?{type:"Literal",value:l[r],raw:r}:"this"===r?{type:"ThisExpression"}:{type:"Identifier",name:r}},O=function(e){for(var r,t,o=[],i=!1;a<P;){if(b(),(r=v(a))===e){i=!0,a++;break}44===r?a++:((t=x())&&"Compound"!==t.type||n("Expected comma",a),o.push(t))}return i||n("Expected "+String.fromCharCode(e),a),o},w=function(){var e,r;for(r=40===(e=v(a))?j():S(),b(),e=v(a);46===e||91===e||40===e;)a++,46===e?(b(),r={type:"MemberExpression",computed:!1,object:r,property:S()}):91===e?(r={type:"MemberExpression",computed:!0,object:r,property:x()},b(),93!==(e=v(a))&&n("Unclosed [",a),a++):40===e&&(r={type:"CallExpression",arguments:O(41),callee:r}),b(),e=v(a);return r},j=function(){a++;var e=x();if(b(),41===v(a))return a++,e;n("Unclosed (",a)},M=function(){return a++,{type:"ArrayExpression",elements:O(93)}},Q=[];a<P;)59===(r=v(a))||44===r?a++:(t=x())?Q.push(t):a<P&&n('Unexpected "'+m(a)+'"',a);return 1===Q.length?Q[0]:{type:"Compound",body:Q}};d.version="0.3.4",d.toString=function(){return"JavaScript Expression Parser (JSEP) v"+d.version},d.addUnaryOp=function(e){return s=Math.max(e.length,s),o[e]=!0,this},d.addBinaryOp=function(e,r){return u=Math.max(e.length,u),i[e]=r,this},d.addLiteral=function(e,r){return l[e]=r,this},d.removeUnaryOp=function(e){return delete o[e],e.length===s&&(s=a(o)),this},d.removeAllUnaryOps=function(){return o={},s=0,this},d.removeBinaryOp=function(e){return delete i[e],e.length===u&&(u=a(i)),this},d.removeAllBinaryOps=function(){return i={},u=0,this},d.removeLiteral=function(e){return delete l[e],this},d.removeAllLiterals=function(){return l={},this},e.exports?r=e.exports=d:r.parse=d}()},function(e,r,t){"use strict";t.r(r);var n=t(0),o=t.n(n),i=t(1);class a{static basicPlusOperator(e,r){return e+r}static basicMinusOperator(e,r){return e-r}static basicMultipleOperator(e,r){return e*r}static basicDivideOperator(e,r){return e/r}static basicModuloOperator(e,r){return e%r}}class s{constructor(){this.pointer=new o.a}evaluateSingle(e,r){const t=this.pointer.executeQuery(r,e);return t.isQueryValid?t.getSingle():null}evaluateMulti(e,r){const t=this.pointer.executeQuery(r,e);return t.isQueryValid?t.getAll():[]}}class u{constructor(e){this.pointerEvaluator=new s,this.jsep=i,this.jsep.addUnaryOp("@"),this.jsep.addUnaryOp("@*"),this.scope=e&&e.scope?e.scope:null}evaluate(e,r){const t="string"==typeof e?this.parseTree(e):{tree:e,error:!1,value:null,errorMessage:""};if(!t.error)try{const e=r?r.scope:this.scope,n=this.processNode(t.tree,{scope:e});t.value=n}catch(e){t.error=!0,t.errorMessage=e}return t}parseTree(e){try{return{tree:this.jsep(e),error:!1,errorMessage:""}}catch(e){return{error:!0,errorMessage:e.message}}}processNode(e,r){switch(e.type){case"Literal":return e.value;case"Identifier":return this.resolveIdentifier(e,r);case"BinaryExpression":return this.resolveBinaryExpression(e,r);case"UnaryExpression":return this.resolveUnaryExpression(e,r);case"MemberExpression":return this.resolveMemberExpression(e,r);case"CallExpression":return this.resolveCallExpression(e,r);case"ConditionalExpression":return this.resolveConditionalExpression(e,r);default:throw new Error("Could not resolve: "+e.type)}}resolveBinaryExpression(e,r){switch(e.operator){case"+":return a.basicPlusOperator(this.processNode(e.left,r),this.processNode(e.right,r));case"-":return a.basicMinusOperator(this.processNode(e.left,r),this.processNode(e.right,r));case"*":return a.basicMultipleOperator(this.processNode(e.left,r),this.processNode(e.right,r));case"/":return a.basicDivideOperator(this.processNode(e.left,r),this.processNode(e.right,r));case"%":return a.basicModuloOperator(this.processNode(e.left,r),this.processNode(e.right,r));case"&&":return this.processNode(e.left,r)&&this.processNode(e.right,r);case"||":return this.processNode(e.left,r)||this.processNode(e.right,r);case"==":return this.processNode(e.left,r)==this.processNode(e.right,r);case"===":return this.processNode(e.left,r)===this.processNode(e.right,r);case"!=":case"!==":return this.processNode(e.left,r)!==this.processNode(e.right,r);case">":return this.processNode(e.left,r)>this.processNode(e.right,r);case">=":return this.processNode(e.left,r)>=this.processNode(e.right,r);case"<":return this.processNode(e.left,r)<this.processNode(e.right,r);case"<=":return this.processNode(e.left,r)<=this.processNode(e.right,r);case"|":return this.resolvePipeExpression(e.right,e.left,r);default:throw new Error("Could not find operator: "+e.operator)}}resolveUnaryExpression(e,r){const t=this.processNode(e.argument,r);switch(e.operator){case"@":return this.pointerEvaluator.evaluateSingle(t,r.scope);case"@*":return this.pointerEvaluator.evaluateMulti(t,r.scope);case"+":return t;case"-":return-t;default:throw new Error("Could not find operator: "+e.operator)}}resolveConditionalExpression(e,r){return this.processNode(e.test,r)?e.consequent:e.alternate}resolveIdentifier(e,r){if(!r.startedQueryConcatenation){return this.pointerEvaluator.evaluateSingle("."+e.name,r.scope)}return e.name}resolveMemberExpression(e,r){const t=!r.startedQueryConcatenation,n=JSON.parse(JSON.stringify(r));n.startedQueryConcatenation=!0;const o=this.processNode(e.object,n)+'["'+this.processNode(e.property,n)+'"]';if(t){return this.pointerEvaluator.evaluateSingle("."+o,r.scope)}return o}resolveCallExpression(e,r){const t=this.processNode(e.callee,r);if(t&&t instanceof Function){const n=[];return e.arguments&&e.arguments.length&&e.arguments.forEach(e=>{n.push(this.processNode(e,r))}),t(...n)}throw new Error(t+" is not a function")}resolvePipeExpression(e,r,t){const n=this.processNode(e,t);if(n&&n instanceof Function){return n(this.processNode(r,t))}throw new Error(n+" is not a function")}}t.d(r,"default",function(){return l});class l{constructor(){this.evaluator=new u,this.pointer=new o.a,this.schemas=[]}setGlobalScope(e={}){this.scope=e}setSchema(e,r=[],t={}){const n=this.schemas.filter(r=>r.name===e);n.length?n[0].rules=r:this.schemas.push({name:e,rules:r,scope:t,schemas:[]})}deleteSchema(e){this.schemas=this.schemas.filter(r=>r.name!==e)}addRuleToSchema(e,r,t){const n=this.getSchema(e);if(!n)return;const o=this.pointer.createQuery(r),i=this.evaluator.parseTree(t);n.rules.push({targetQueryString:r,targetQuery:o,ruleExpression:i.tree})}addSchemaToSchema(e,r,t){const n=this.getSchema(e);if(!n)return;const o=this.pointer.createQuery(r);n.schemas.push({targetQueryString:r,targetQuery:o,schemaName:t})}setSchemaScope(e,r={}){const t=this.getSchema(e);t&&(t.scope=r)}enhance(e,r){const t=this.getSchema(r);t&&(this.enhanceSchemas(e,t),this.enhanceRules(e,t))}getSchema(e){const r=this.schemas.filter(r=>r.name===e);return r.length?r[0]:null}enhanceSchemas(e,r){r.schemas.forEach(r=>{if(!this.getSchema(r.schemaName))return;const t=this.pointer.executeQuery(e,r.targetQuery);t.error||t.getAll().forEach((e,t)=>{this.enhanceSchemaInArrays(e,r.schemaName)})})}enhanceSchemaInArrays(e,r){Array.isArray(e)?e.forEach(e=>{this.enhanceSchemaInArrays(e,r)}):this.enhance(e,r)}enhanceRules(e,r){const t={item:e};r.rules.forEach(n=>{if(n.ruleExpression){const o=this.pointer.executeQuery(e,n.targetQuery);o.error||o.getAll().forEach((e,i)=>{const a=o.parentsAt(i),s={target:e};let u=s;a.forEach(e=>{u.parent={value:e},u=u.parent});const l={...this.scope,...r.scope,...t,...s},c=this.evaluator.evaluate(n.ruleExpression,{scope:l});c.error||o.setAt(c.value,i)})}})}}}]).default});